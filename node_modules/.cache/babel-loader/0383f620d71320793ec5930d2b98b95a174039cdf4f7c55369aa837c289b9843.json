{"ast":null,"code":"'use strict';\n\nconst assert = require('node:assert');\nconst {\n  kDestroyed,\n  kBodyUsed,\n  kListeners,\n  kBody\n} = require('./symbols');\nconst {\n  IncomingMessage\n} = require('node:http');\nconst stream = require('node:stream');\nconst net = require('node:net');\nconst {\n  Blob\n} = require('node:buffer');\nconst nodeUtil = require('node:util');\nconst {\n  stringify\n} = require('node:querystring');\nconst {\n  EventEmitter: EE\n} = require('node:events');\nconst {\n  InvalidArgumentError\n} = require('./errors');\nconst {\n  headerNameLowerCasedRecord\n} = require('./constants');\nconst {\n  tree\n} = require('./tree');\nconst [nodeMajor, nodeMinor] = process.versions.node.split('.').map(v => Number(v));\nclass BodyAsyncIterable {\n  constructor(body) {\n    this[kBody] = body;\n    this[kBodyUsed] = false;\n  }\n  async *[Symbol.asyncIterator]() {\n    assert(!this[kBodyUsed], 'disturbed');\n    this[kBodyUsed] = true;\n    yield* this[kBody];\n  }\n}\nfunction wrapRequestBody(body) {\n  if (isStream(body)) {\n    // TODO (fix): Provide some way for the user to cache the file to e.g. /tmp\n    // so that it can be dispatched again?\n    // TODO (fix): Do we need 100-expect support to provide a way to do this properly?\n    if (bodyLength(body) === 0) {\n      body.on('data', function () {\n        assert(false);\n      });\n    }\n    if (typeof body.readableDidRead !== 'boolean') {\n      body[kBodyUsed] = false;\n      EE.prototype.on.call(body, 'data', function () {\n        this[kBodyUsed] = true;\n      });\n    }\n    return body;\n  } else if (body && typeof body.pipeTo === 'function') {\n    // TODO (fix): We can't access ReadableStream internal state\n    // to determine whether or not it has been disturbed. This is just\n    // a workaround.\n    return new BodyAsyncIterable(body);\n  } else if (body && typeof body !== 'string' && !ArrayBuffer.isView(body) && isIterable(body)) {\n    // TODO: Should we allow re-using iterable if !this.opts.idempotent\n    // or through some other flag?\n    return new BodyAsyncIterable(body);\n  } else {\n    return body;\n  }\n}\nfunction nop() {}\nfunction isStream(obj) {\n  return obj && typeof obj === 'object' && typeof obj.pipe === 'function' && typeof obj.on === 'function';\n}\n\n// based on https://github.com/node-fetch/fetch-blob/blob/8ab587d34080de94140b54f07168451e7d0b655e/index.js#L229-L241 (MIT License)\nfunction isBlobLike(object) {\n  if (object === null) {\n    return false;\n  } else if (object instanceof Blob) {\n    return true;\n  } else if (typeof object !== 'object') {\n    return false;\n  } else {\n    const sTag = object[Symbol.toStringTag];\n    return (sTag === 'Blob' || sTag === 'File') && ('stream' in object && typeof object.stream === 'function' || 'arrayBuffer' in object && typeof object.arrayBuffer === 'function');\n  }\n}\nfunction buildURL(url, queryParams) {\n  if (url.includes('?') || url.includes('#')) {\n    throw new Error('Query params cannot be passed when url already contains \"?\" or \"#\".');\n  }\n  const stringified = stringify(queryParams);\n  if (stringified) {\n    url += '?' + stringified;\n  }\n  return url;\n}\nfunction isValidPort(port) {\n  const value = parseInt(port, 10);\n  return value === Number(port) && value >= 0 && value <= 65535;\n}\nfunction isHttpOrHttpsPrefixed(value) {\n  return value != null && value[0] === 'h' && value[1] === 't' && value[2] === 't' && value[3] === 'p' && (value[4] === ':' || value[4] === 's' && value[5] === ':');\n}\nfunction parseURL(url) {\n  if (typeof url === 'string') {\n    url = new URL(url);\n    if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n      throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.');\n    }\n    return url;\n  }\n  if (!url || typeof url !== 'object') {\n    throw new InvalidArgumentError('Invalid URL: The URL argument must be a non-null object.');\n  }\n  if (!(url instanceof URL)) {\n    if (url.port != null && url.port !== '' && isValidPort(url.port) === false) {\n      throw new InvalidArgumentError('Invalid URL: port must be a valid integer or a string representation of an integer.');\n    }\n    if (url.path != null && typeof url.path !== 'string') {\n      throw new InvalidArgumentError('Invalid URL path: the path must be a string or null/undefined.');\n    }\n    if (url.pathname != null && typeof url.pathname !== 'string') {\n      throw new InvalidArgumentError('Invalid URL pathname: the pathname must be a string or null/undefined.');\n    }\n    if (url.hostname != null && typeof url.hostname !== 'string') {\n      throw new InvalidArgumentError('Invalid URL hostname: the hostname must be a string or null/undefined.');\n    }\n    if (url.origin != null && typeof url.origin !== 'string') {\n      throw new InvalidArgumentError('Invalid URL origin: the origin must be a string or null/undefined.');\n    }\n    if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n      throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.');\n    }\n    const port = url.port != null ? url.port : url.protocol === 'https:' ? 443 : 80;\n    let origin = url.origin != null ? url.origin : `${url.protocol || ''}//${url.hostname || ''}:${port}`;\n    let path = url.path != null ? url.path : `${url.pathname || ''}${url.search || ''}`;\n    if (origin[origin.length - 1] === '/') {\n      origin = origin.slice(0, origin.length - 1);\n    }\n    if (path && path[0] !== '/') {\n      path = `/${path}`;\n    }\n    // new URL(path, origin) is unsafe when `path` contains an absolute URL\n    // From https://developer.mozilla.org/en-US/docs/Web/API/URL/URL:\n    // If first parameter is a relative URL, second param is required, and will be used as the base URL.\n    // If first parameter is an absolute URL, a given second param will be ignored.\n    return new URL(`${origin}${path}`);\n  }\n  if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n    throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.');\n  }\n  return url;\n}\nfunction parseOrigin(url) {\n  url = parseURL(url);\n  if (url.pathname !== '/' || url.search || url.hash) {\n    throw new InvalidArgumentError('invalid url');\n  }\n  return url;\n}\nfunction getHostname(host) {\n  if (host[0] === '[') {\n    const idx = host.indexOf(']');\n    assert(idx !== -1);\n    return host.substring(1, idx);\n  }\n  const idx = host.indexOf(':');\n  if (idx === -1) return host;\n  return host.substring(0, idx);\n}\n\n// IP addresses are not valid server names per RFC6066\n// > Currently, the only server names supported are DNS hostnames\nfunction getServerName(host) {\n  if (!host) {\n    return null;\n  }\n  assert.strictEqual(typeof host, 'string');\n  const servername = getHostname(host);\n  if (net.isIP(servername)) {\n    return '';\n  }\n  return servername;\n}\nfunction deepClone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\nfunction isAsyncIterable(obj) {\n  return !!(obj != null && typeof obj[Symbol.asyncIterator] === 'function');\n}\nfunction isIterable(obj) {\n  return !!(obj != null && (typeof obj[Symbol.iterator] === 'function' || typeof obj[Symbol.asyncIterator] === 'function'));\n}\nfunction bodyLength(body) {\n  if (body == null) {\n    return 0;\n  } else if (isStream(body)) {\n    const state = body._readableState;\n    return state && state.objectMode === false && state.ended === true && Number.isFinite(state.length) ? state.length : null;\n  } else if (isBlobLike(body)) {\n    return body.size != null ? body.size : null;\n  } else if (isBuffer(body)) {\n    return body.byteLength;\n  }\n  return null;\n}\nfunction isDestroyed(body) {\n  return body && !!(body.destroyed || body[kDestroyed] || stream.isDestroyed?.(body));\n}\nfunction destroy(stream, err) {\n  if (stream == null || !isStream(stream) || isDestroyed(stream)) {\n    return;\n  }\n  if (typeof stream.destroy === 'function') {\n    if (Object.getPrototypeOf(stream).constructor === IncomingMessage) {\n      // See: https://github.com/nodejs/node/pull/38505/files\n      stream.socket = null;\n    }\n    stream.destroy(err);\n  } else if (err) {\n    queueMicrotask(() => {\n      stream.emit('error', err);\n    });\n  }\n  if (stream.destroyed !== true) {\n    stream[kDestroyed] = true;\n  }\n}\nconst KEEPALIVE_TIMEOUT_EXPR = /timeout=(\\d+)/;\nfunction parseKeepAliveTimeout(val) {\n  const m = val.toString().match(KEEPALIVE_TIMEOUT_EXPR);\n  return m ? parseInt(m[1], 10) * 1000 : null;\n}\n\n/**\n * Retrieves a header name and returns its lowercase value.\n * @param {string | Buffer} value Header name\n * @returns {string}\n */\nfunction headerNameToString(value) {\n  return typeof value === 'string' ? headerNameLowerCasedRecord[value] ?? value.toLowerCase() : tree.lookup(value) ?? value.toString('latin1').toLowerCase();\n}\n\n/**\n * Receive the buffer as a string and return its lowercase value.\n * @param {Buffer} value Header name\n * @returns {string}\n */\nfunction bufferToLowerCasedHeaderName(value) {\n  return tree.lookup(value) ?? value.toString('latin1').toLowerCase();\n}\n\n/**\n * @param {Record<string, string | string[]> | (Buffer | string | (Buffer | string)[])[]} headers\n * @param {Record<string, string | string[]>} [obj]\n * @returns {Record<string, string | string[]>}\n */\nfunction parseHeaders(headers, obj) {\n  if (obj === undefined) obj = {};\n  for (let i = 0; i < headers.length; i += 2) {\n    const key = headerNameToString(headers[i]);\n    let val = obj[key];\n    if (val) {\n      if (typeof val === 'string') {\n        val = [val];\n        obj[key] = val;\n      }\n      val.push(headers[i + 1].toString('utf8'));\n    } else {\n      const headersValue = headers[i + 1];\n      if (typeof headersValue === 'string') {\n        obj[key] = headersValue;\n      } else {\n        obj[key] = Array.isArray(headersValue) ? headersValue.map(x => x.toString('utf8')) : headersValue.toString('utf8');\n      }\n    }\n  }\n\n  // See https://github.com/nodejs/node/pull/46528\n  if ('content-length' in obj && 'content-disposition' in obj) {\n    obj['content-disposition'] = Buffer.from(obj['content-disposition']).toString('latin1');\n  }\n  return obj;\n}\nfunction parseRawHeaders(headers) {\n  const len = headers.length;\n  const ret = new Array(len);\n  let hasContentLength = false;\n  let contentDispositionIdx = -1;\n  let key;\n  let val;\n  let kLen = 0;\n  for (let n = 0; n < headers.length; n += 2) {\n    key = headers[n];\n    val = headers[n + 1];\n    typeof key !== 'string' && (key = key.toString());\n    typeof val !== 'string' && (val = val.toString('utf8'));\n    kLen = key.length;\n    if (kLen === 14 && key[7] === '-' && (key === 'content-length' || key.toLowerCase() === 'content-length')) {\n      hasContentLength = true;\n    } else if (kLen === 19 && key[7] === '-' && (key === 'content-disposition' || key.toLowerCase() === 'content-disposition')) {\n      contentDispositionIdx = n + 1;\n    }\n    ret[n] = key;\n    ret[n + 1] = val;\n  }\n\n  // See https://github.com/nodejs/node/pull/46528\n  if (hasContentLength && contentDispositionIdx !== -1) {\n    ret[contentDispositionIdx] = Buffer.from(ret[contentDispositionIdx]).toString('latin1');\n  }\n  return ret;\n}\nfunction isBuffer(buffer) {\n  // See, https://github.com/mcollina/undici/pull/319\n  return buffer instanceof Uint8Array || Buffer.isBuffer(buffer);\n}\nfunction validateHandler(handler, method, upgrade) {\n  if (!handler || typeof handler !== 'object') {\n    throw new InvalidArgumentError('handler must be an object');\n  }\n  if (typeof handler.onConnect !== 'function') {\n    throw new InvalidArgumentError('invalid onConnect method');\n  }\n  if (typeof handler.onError !== 'function') {\n    throw new InvalidArgumentError('invalid onError method');\n  }\n  if (typeof handler.onBodySent !== 'function' && handler.onBodySent !== undefined) {\n    throw new InvalidArgumentError('invalid onBodySent method');\n  }\n  if (upgrade || method === 'CONNECT') {\n    if (typeof handler.onUpgrade !== 'function') {\n      throw new InvalidArgumentError('invalid onUpgrade method');\n    }\n  } else {\n    if (typeof handler.onHeaders !== 'function') {\n      throw new InvalidArgumentError('invalid onHeaders method');\n    }\n    if (typeof handler.onData !== 'function') {\n      throw new InvalidArgumentError('invalid onData method');\n    }\n    if (typeof handler.onComplete !== 'function') {\n      throw new InvalidArgumentError('invalid onComplete method');\n    }\n  }\n}\n\n// A body is disturbed if it has been read from and it cannot\n// be re-used without losing state or data.\nfunction isDisturbed(body) {\n  // TODO (fix): Why is body[kBodyUsed] needed?\n  return !!(body && (stream.isDisturbed(body) || body[kBodyUsed]));\n}\nfunction isErrored(body) {\n  return !!(body && stream.isErrored(body));\n}\nfunction isReadable(body) {\n  return !!(body && stream.isReadable(body));\n}\nfunction getSocketInfo(socket) {\n  return {\n    localAddress: socket.localAddress,\n    localPort: socket.localPort,\n    remoteAddress: socket.remoteAddress,\n    remotePort: socket.remotePort,\n    remoteFamily: socket.remoteFamily,\n    timeout: socket.timeout,\n    bytesWritten: socket.bytesWritten,\n    bytesRead: socket.bytesRead\n  };\n}\n\n/** @type {globalThis['ReadableStream']} */\nfunction ReadableStreamFrom(iterable) {\n  // We cannot use ReadableStream.from here because it does not return a byte stream.\n\n  let iterator;\n  return new ReadableStream({\n    async start() {\n      iterator = iterable[Symbol.asyncIterator]();\n    },\n    async pull(controller) {\n      const {\n        done,\n        value\n      } = await iterator.next();\n      if (done) {\n        queueMicrotask(() => {\n          controller.close();\n          controller.byobRequest?.respond(0);\n        });\n      } else {\n        const buf = Buffer.isBuffer(value) ? value : Buffer.from(value);\n        if (buf.byteLength) {\n          controller.enqueue(new Uint8Array(buf));\n        }\n      }\n      return controller.desiredSize > 0;\n    },\n    async cancel(reason) {\n      await iterator.return();\n    },\n    type: 'bytes'\n  });\n}\n\n// The chunk should be a FormData instance and contains\n// all the required methods.\nfunction isFormDataLike(object) {\n  return object && typeof object === 'object' && typeof object.append === 'function' && typeof object.delete === 'function' && typeof object.get === 'function' && typeof object.getAll === 'function' && typeof object.has === 'function' && typeof object.set === 'function' && object[Symbol.toStringTag] === 'FormData';\n}\nfunction addAbortListener(signal, listener) {\n  if ('addEventListener' in signal) {\n    signal.addEventListener('abort', listener, {\n      once: true\n    });\n    return () => signal.removeEventListener('abort', listener);\n  }\n  signal.addListener('abort', listener);\n  return () => signal.removeListener('abort', listener);\n}\nconst hasToWellFormed = typeof String.prototype.toWellFormed === 'function';\nconst hasIsWellFormed = typeof String.prototype.isWellFormed === 'function';\n\n/**\n * @param {string} val\n */\nfunction toUSVString(val) {\n  return hasToWellFormed ? `${val}`.toWellFormed() : nodeUtil.toUSVString(val);\n}\n\n/**\n * @param {string} val\n */\n// TODO: move this to webidl\nfunction isUSVString(val) {\n  return hasIsWellFormed ? `${val}`.isWellFormed() : toUSVString(val) === `${val}`;\n}\n\n/**\n * @see https://tools.ietf.org/html/rfc7230#section-3.2.6\n * @param {number} c\n */\nfunction isTokenCharCode(c) {\n  switch (c) {\n    case 0x22:\n    case 0x28:\n    case 0x29:\n    case 0x2c:\n    case 0x2f:\n    case 0x3a:\n    case 0x3b:\n    case 0x3c:\n    case 0x3d:\n    case 0x3e:\n    case 0x3f:\n    case 0x40:\n    case 0x5b:\n    case 0x5c:\n    case 0x5d:\n    case 0x7b:\n    case 0x7d:\n      // DQUOTE and \"(),/:;<=>?@[\\]{}\"\n      return false;\n    default:\n      // VCHAR %x21-7E\n      return c >= 0x21 && c <= 0x7e;\n  }\n}\n\n/**\n * @param {string} characters\n */\nfunction isValidHTTPToken(characters) {\n  if (characters.length === 0) {\n    return false;\n  }\n  for (let i = 0; i < characters.length; ++i) {\n    if (!isTokenCharCode(characters.charCodeAt(i))) {\n      return false;\n    }\n  }\n  return true;\n}\n\n// headerCharRegex have been lifted from\n// https://github.com/nodejs/node/blob/main/lib/_http_common.js\n\n/**\n * Matches if val contains an invalid field-vchar\n *  field-value    = *( field-content / obs-fold )\n *  field-content  = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n *  field-vchar    = VCHAR / obs-text\n */\nconst headerCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\n/**\n * @param {string} characters\n */\nfunction isValidHeaderValue(characters) {\n  return !headerCharRegex.test(characters);\n}\n\n// Parsed accordingly to RFC 9110\n// https://www.rfc-editor.org/rfc/rfc9110#field.content-range\nfunction parseRangeHeader(range) {\n  if (range == null || range === '') return {\n    start: 0,\n    end: null,\n    size: null\n  };\n  const m = range ? range.match(/^bytes (\\d+)-(\\d+)\\/(\\d+)?$/) : null;\n  return m ? {\n    start: parseInt(m[1]),\n    end: m[2] ? parseInt(m[2]) : null,\n    size: m[3] ? parseInt(m[3]) : null\n  } : null;\n}\nfunction addListener(obj, name, listener) {\n  const listeners = obj[kListeners] ??= [];\n  listeners.push([name, listener]);\n  obj.on(name, listener);\n  return obj;\n}\nfunction removeAllListeners(obj) {\n  for (const [name, listener] of obj[kListeners] ?? []) {\n    obj.removeListener(name, listener);\n  }\n  obj[kListeners] = null;\n}\nfunction errorRequest(client, request, err) {\n  try {\n    request.onError(err);\n    assert(request.aborted);\n  } catch (err) {\n    client.emit('error', err);\n  }\n}\nconst kEnumerableProperty = Object.create(null);\nkEnumerableProperty.enumerable = true;\nconst normalizedMethodRecordsBase = {\n  delete: 'DELETE',\n  DELETE: 'DELETE',\n  get: 'GET',\n  GET: 'GET',\n  head: 'HEAD',\n  HEAD: 'HEAD',\n  options: 'OPTIONS',\n  OPTIONS: 'OPTIONS',\n  post: 'POST',\n  POST: 'POST',\n  put: 'PUT',\n  PUT: 'PUT'\n};\nconst normalizedMethodRecords = {\n  ...normalizedMethodRecordsBase,\n  patch: 'patch',\n  PATCH: 'PATCH'\n};\n\n// Note: object prototypes should not be able to be referenced. e.g. `Object#hasOwnProperty`.\nObject.setPrototypeOf(normalizedMethodRecordsBase, null);\nObject.setPrototypeOf(normalizedMethodRecords, null);\nmodule.exports = {\n  kEnumerableProperty,\n  nop,\n  isDisturbed,\n  isErrored,\n  isReadable,\n  toUSVString,\n  isUSVString,\n  isBlobLike,\n  parseOrigin,\n  parseURL,\n  getServerName,\n  isStream,\n  isIterable,\n  isAsyncIterable,\n  isDestroyed,\n  headerNameToString,\n  bufferToLowerCasedHeaderName,\n  addListener,\n  removeAllListeners,\n  errorRequest,\n  parseRawHeaders,\n  parseHeaders,\n  parseKeepAliveTimeout,\n  destroy,\n  bodyLength,\n  deepClone,\n  ReadableStreamFrom,\n  isBuffer,\n  validateHandler,\n  getSocketInfo,\n  isFormDataLike,\n  buildURL,\n  addAbortListener,\n  isValidHTTPToken,\n  isValidHeaderValue,\n  isTokenCharCode,\n  parseRangeHeader,\n  normalizedMethodRecordsBase,\n  normalizedMethodRecords,\n  isValidPort,\n  isHttpOrHttpsPrefixed,\n  nodeMajor,\n  nodeMinor,\n  safeHTTPMethods: ['GET', 'HEAD', 'OPTIONS', 'TRACE'],\n  wrapRequestBody\n};","map":{"version":3,"names":["assert","require","kDestroyed","kBodyUsed","kListeners","kBody","IncomingMessage","stream","net","Blob","nodeUtil","stringify","EventEmitter","EE","InvalidArgumentError","headerNameLowerCasedRecord","tree","nodeMajor","nodeMinor","process","versions","node","split","map","v","Number","BodyAsyncIterable","constructor","body","Symbol","asyncIterator","wrapRequestBody","isStream","bodyLength","on","readableDidRead","prototype","call","pipeTo","ArrayBuffer","isView","isIterable","nop","obj","pipe","isBlobLike","object","sTag","toStringTag","arrayBuffer","buildURL","url","queryParams","includes","Error","stringified","isValidPort","port","value","parseInt","isHttpOrHttpsPrefixed","parseURL","URL","origin","protocol","path","pathname","hostname","search","length","slice","parseOrigin","hash","getHostname","host","idx","indexOf","substring","getServerName","strictEqual","servername","isIP","deepClone","JSON","parse","isAsyncIterable","iterator","state","_readableState","objectMode","ended","isFinite","size","isBuffer","byteLength","isDestroyed","destroyed","destroy","err","Object","getPrototypeOf","socket","queueMicrotask","emit","KEEPALIVE_TIMEOUT_EXPR","parseKeepAliveTimeout","val","m","toString","match","headerNameToString","toLowerCase","lookup","bufferToLowerCasedHeaderName","parseHeaders","headers","undefined","i","key","push","headersValue","Array","isArray","x","Buffer","from","parseRawHeaders","len","ret","hasContentLength","contentDispositionIdx","kLen","n","buffer","Uint8Array","validateHandler","handler","method","upgrade","onConnect","onError","onBodySent","onUpgrade","onHeaders","onData","onComplete","isDisturbed","isErrored","isReadable","getSocketInfo","localAddress","localPort","remoteAddress","remotePort","remoteFamily","timeout","bytesWritten","bytesRead","ReadableStreamFrom","iterable","ReadableStream","start","pull","controller","done","next","close","byobRequest","respond","buf","enqueue","desiredSize","cancel","reason","return","type","isFormDataLike","append","delete","get","getAll","has","set","addAbortListener","signal","listener","addEventListener","once","removeEventListener","addListener","removeListener","hasToWellFormed","String","toWellFormed","hasIsWellFormed","isWellFormed","toUSVString","isUSVString","isTokenCharCode","c","isValidHTTPToken","characters","charCodeAt","headerCharRegex","isValidHeaderValue","test","parseRangeHeader","range","end","name","listeners","removeAllListeners","errorRequest","client","request","aborted","kEnumerableProperty","create","enumerable","normalizedMethodRecordsBase","DELETE","GET","head","HEAD","options","OPTIONS","post","POST","put","PUT","normalizedMethodRecords","patch","PATCH","setPrototypeOf","module","exports","safeHTTPMethods"],"sources":["/Users/nataliia/PussyProjects/react-app/node_modules/undici/lib/core/util.js"],"sourcesContent":["'use strict'\n\nconst assert = require('node:assert')\nconst { kDestroyed, kBodyUsed, kListeners, kBody } = require('./symbols')\nconst { IncomingMessage } = require('node:http')\nconst stream = require('node:stream')\nconst net = require('node:net')\nconst { Blob } = require('node:buffer')\nconst nodeUtil = require('node:util')\nconst { stringify } = require('node:querystring')\nconst { EventEmitter: EE } = require('node:events')\nconst { InvalidArgumentError } = require('./errors')\nconst { headerNameLowerCasedRecord } = require('./constants')\nconst { tree } = require('./tree')\n\nconst [nodeMajor, nodeMinor] = process.versions.node.split('.').map(v => Number(v))\n\nclass BodyAsyncIterable {\n  constructor (body) {\n    this[kBody] = body\n    this[kBodyUsed] = false\n  }\n\n  async * [Symbol.asyncIterator] () {\n    assert(!this[kBodyUsed], 'disturbed')\n    this[kBodyUsed] = true\n    yield * this[kBody]\n  }\n}\n\nfunction wrapRequestBody (body) {\n  if (isStream(body)) {\n    // TODO (fix): Provide some way for the user to cache the file to e.g. /tmp\n    // so that it can be dispatched again?\n    // TODO (fix): Do we need 100-expect support to provide a way to do this properly?\n    if (bodyLength(body) === 0) {\n      body\n        .on('data', function () {\n          assert(false)\n        })\n    }\n\n    if (typeof body.readableDidRead !== 'boolean') {\n      body[kBodyUsed] = false\n      EE.prototype.on.call(body, 'data', function () {\n        this[kBodyUsed] = true\n      })\n    }\n\n    return body\n  } else if (body && typeof body.pipeTo === 'function') {\n    // TODO (fix): We can't access ReadableStream internal state\n    // to determine whether or not it has been disturbed. This is just\n    // a workaround.\n    return new BodyAsyncIterable(body)\n  } else if (\n    body &&\n    typeof body !== 'string' &&\n    !ArrayBuffer.isView(body) &&\n    isIterable(body)\n  ) {\n    // TODO: Should we allow re-using iterable if !this.opts.idempotent\n    // or through some other flag?\n    return new BodyAsyncIterable(body)\n  } else {\n    return body\n  }\n}\n\nfunction nop () {}\n\nfunction isStream (obj) {\n  return obj && typeof obj === 'object' && typeof obj.pipe === 'function' && typeof obj.on === 'function'\n}\n\n// based on https://github.com/node-fetch/fetch-blob/blob/8ab587d34080de94140b54f07168451e7d0b655e/index.js#L229-L241 (MIT License)\nfunction isBlobLike (object) {\n  if (object === null) {\n    return false\n  } else if (object instanceof Blob) {\n    return true\n  } else if (typeof object !== 'object') {\n    return false\n  } else {\n    const sTag = object[Symbol.toStringTag]\n\n    return (sTag === 'Blob' || sTag === 'File') && (\n      ('stream' in object && typeof object.stream === 'function') ||\n      ('arrayBuffer' in object && typeof object.arrayBuffer === 'function')\n    )\n  }\n}\n\nfunction buildURL (url, queryParams) {\n  if (url.includes('?') || url.includes('#')) {\n    throw new Error('Query params cannot be passed when url already contains \"?\" or \"#\".')\n  }\n\n  const stringified = stringify(queryParams)\n\n  if (stringified) {\n    url += '?' + stringified\n  }\n\n  return url\n}\n\nfunction isValidPort (port) {\n  const value = parseInt(port, 10)\n  return (\n    value === Number(port) &&\n    value >= 0 &&\n    value <= 65535\n  )\n}\n\nfunction isHttpOrHttpsPrefixed (value) {\n  return (\n    value != null &&\n    value[0] === 'h' &&\n    value[1] === 't' &&\n    value[2] === 't' &&\n    value[3] === 'p' &&\n    (\n      value[4] === ':' ||\n      (\n        value[4] === 's' &&\n        value[5] === ':'\n      )\n    )\n  )\n}\n\nfunction parseURL (url) {\n  if (typeof url === 'string') {\n    url = new URL(url)\n\n    if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n      throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.')\n    }\n\n    return url\n  }\n\n  if (!url || typeof url !== 'object') {\n    throw new InvalidArgumentError('Invalid URL: The URL argument must be a non-null object.')\n  }\n\n  if (!(url instanceof URL)) {\n    if (url.port != null && url.port !== '' && isValidPort(url.port) === false) {\n      throw new InvalidArgumentError('Invalid URL: port must be a valid integer or a string representation of an integer.')\n    }\n\n    if (url.path != null && typeof url.path !== 'string') {\n      throw new InvalidArgumentError('Invalid URL path: the path must be a string or null/undefined.')\n    }\n\n    if (url.pathname != null && typeof url.pathname !== 'string') {\n      throw new InvalidArgumentError('Invalid URL pathname: the pathname must be a string or null/undefined.')\n    }\n\n    if (url.hostname != null && typeof url.hostname !== 'string') {\n      throw new InvalidArgumentError('Invalid URL hostname: the hostname must be a string or null/undefined.')\n    }\n\n    if (url.origin != null && typeof url.origin !== 'string') {\n      throw new InvalidArgumentError('Invalid URL origin: the origin must be a string or null/undefined.')\n    }\n\n    if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n      throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.')\n    }\n\n    const port = url.port != null\n      ? url.port\n      : (url.protocol === 'https:' ? 443 : 80)\n    let origin = url.origin != null\n      ? url.origin\n      : `${url.protocol || ''}//${url.hostname || ''}:${port}`\n    let path = url.path != null\n      ? url.path\n      : `${url.pathname || ''}${url.search || ''}`\n\n    if (origin[origin.length - 1] === '/') {\n      origin = origin.slice(0, origin.length - 1)\n    }\n\n    if (path && path[0] !== '/') {\n      path = `/${path}`\n    }\n    // new URL(path, origin) is unsafe when `path` contains an absolute URL\n    // From https://developer.mozilla.org/en-US/docs/Web/API/URL/URL:\n    // If first parameter is a relative URL, second param is required, and will be used as the base URL.\n    // If first parameter is an absolute URL, a given second param will be ignored.\n    return new URL(`${origin}${path}`)\n  }\n\n  if (!isHttpOrHttpsPrefixed(url.origin || url.protocol)) {\n    throw new InvalidArgumentError('Invalid URL protocol: the URL must start with `http:` or `https:`.')\n  }\n\n  return url\n}\n\nfunction parseOrigin (url) {\n  url = parseURL(url)\n\n  if (url.pathname !== '/' || url.search || url.hash) {\n    throw new InvalidArgumentError('invalid url')\n  }\n\n  return url\n}\n\nfunction getHostname (host) {\n  if (host[0] === '[') {\n    const idx = host.indexOf(']')\n\n    assert(idx !== -1)\n    return host.substring(1, idx)\n  }\n\n  const idx = host.indexOf(':')\n  if (idx === -1) return host\n\n  return host.substring(0, idx)\n}\n\n// IP addresses are not valid server names per RFC6066\n// > Currently, the only server names supported are DNS hostnames\nfunction getServerName (host) {\n  if (!host) {\n    return null\n  }\n\n  assert.strictEqual(typeof host, 'string')\n\n  const servername = getHostname(host)\n  if (net.isIP(servername)) {\n    return ''\n  }\n\n  return servername\n}\n\nfunction deepClone (obj) {\n  return JSON.parse(JSON.stringify(obj))\n}\n\nfunction isAsyncIterable (obj) {\n  return !!(obj != null && typeof obj[Symbol.asyncIterator] === 'function')\n}\n\nfunction isIterable (obj) {\n  return !!(obj != null && (typeof obj[Symbol.iterator] === 'function' || typeof obj[Symbol.asyncIterator] === 'function'))\n}\n\nfunction bodyLength (body) {\n  if (body == null) {\n    return 0\n  } else if (isStream(body)) {\n    const state = body._readableState\n    return state && state.objectMode === false && state.ended === true && Number.isFinite(state.length)\n      ? state.length\n      : null\n  } else if (isBlobLike(body)) {\n    return body.size != null ? body.size : null\n  } else if (isBuffer(body)) {\n    return body.byteLength\n  }\n\n  return null\n}\n\nfunction isDestroyed (body) {\n  return body && !!(body.destroyed || body[kDestroyed] || (stream.isDestroyed?.(body)))\n}\n\nfunction destroy (stream, err) {\n  if (stream == null || !isStream(stream) || isDestroyed(stream)) {\n    return\n  }\n\n  if (typeof stream.destroy === 'function') {\n    if (Object.getPrototypeOf(stream).constructor === IncomingMessage) {\n      // See: https://github.com/nodejs/node/pull/38505/files\n      stream.socket = null\n    }\n\n    stream.destroy(err)\n  } else if (err) {\n    queueMicrotask(() => {\n      stream.emit('error', err)\n    })\n  }\n\n  if (stream.destroyed !== true) {\n    stream[kDestroyed] = true\n  }\n}\n\nconst KEEPALIVE_TIMEOUT_EXPR = /timeout=(\\d+)/\nfunction parseKeepAliveTimeout (val) {\n  const m = val.toString().match(KEEPALIVE_TIMEOUT_EXPR)\n  return m ? parseInt(m[1], 10) * 1000 : null\n}\n\n/**\n * Retrieves a header name and returns its lowercase value.\n * @param {string | Buffer} value Header name\n * @returns {string}\n */\nfunction headerNameToString (value) {\n  return typeof value === 'string'\n    ? headerNameLowerCasedRecord[value] ?? value.toLowerCase()\n    : tree.lookup(value) ?? value.toString('latin1').toLowerCase()\n}\n\n/**\n * Receive the buffer as a string and return its lowercase value.\n * @param {Buffer} value Header name\n * @returns {string}\n */\nfunction bufferToLowerCasedHeaderName (value) {\n  return tree.lookup(value) ?? value.toString('latin1').toLowerCase()\n}\n\n/**\n * @param {Record<string, string | string[]> | (Buffer | string | (Buffer | string)[])[]} headers\n * @param {Record<string, string | string[]>} [obj]\n * @returns {Record<string, string | string[]>}\n */\nfunction parseHeaders (headers, obj) {\n  if (obj === undefined) obj = {}\n  for (let i = 0; i < headers.length; i += 2) {\n    const key = headerNameToString(headers[i])\n    let val = obj[key]\n\n    if (val) {\n      if (typeof val === 'string') {\n        val = [val]\n        obj[key] = val\n      }\n      val.push(headers[i + 1].toString('utf8'))\n    } else {\n      const headersValue = headers[i + 1]\n      if (typeof headersValue === 'string') {\n        obj[key] = headersValue\n      } else {\n        obj[key] = Array.isArray(headersValue) ? headersValue.map(x => x.toString('utf8')) : headersValue.toString('utf8')\n      }\n    }\n  }\n\n  // See https://github.com/nodejs/node/pull/46528\n  if ('content-length' in obj && 'content-disposition' in obj) {\n    obj['content-disposition'] = Buffer.from(obj['content-disposition']).toString('latin1')\n  }\n\n  return obj\n}\n\nfunction parseRawHeaders (headers) {\n  const len = headers.length\n  const ret = new Array(len)\n\n  let hasContentLength = false\n  let contentDispositionIdx = -1\n  let key\n  let val\n  let kLen = 0\n\n  for (let n = 0; n < headers.length; n += 2) {\n    key = headers[n]\n    val = headers[n + 1]\n\n    typeof key !== 'string' && (key = key.toString())\n    typeof val !== 'string' && (val = val.toString('utf8'))\n\n    kLen = key.length\n    if (kLen === 14 && key[7] === '-' && (key === 'content-length' || key.toLowerCase() === 'content-length')) {\n      hasContentLength = true\n    } else if (kLen === 19 && key[7] === '-' && (key === 'content-disposition' || key.toLowerCase() === 'content-disposition')) {\n      contentDispositionIdx = n + 1\n    }\n    ret[n] = key\n    ret[n + 1] = val\n  }\n\n  // See https://github.com/nodejs/node/pull/46528\n  if (hasContentLength && contentDispositionIdx !== -1) {\n    ret[contentDispositionIdx] = Buffer.from(ret[contentDispositionIdx]).toString('latin1')\n  }\n\n  return ret\n}\n\nfunction isBuffer (buffer) {\n  // See, https://github.com/mcollina/undici/pull/319\n  return buffer instanceof Uint8Array || Buffer.isBuffer(buffer)\n}\n\nfunction validateHandler (handler, method, upgrade) {\n  if (!handler || typeof handler !== 'object') {\n    throw new InvalidArgumentError('handler must be an object')\n  }\n\n  if (typeof handler.onConnect !== 'function') {\n    throw new InvalidArgumentError('invalid onConnect method')\n  }\n\n  if (typeof handler.onError !== 'function') {\n    throw new InvalidArgumentError('invalid onError method')\n  }\n\n  if (typeof handler.onBodySent !== 'function' && handler.onBodySent !== undefined) {\n    throw new InvalidArgumentError('invalid onBodySent method')\n  }\n\n  if (upgrade || method === 'CONNECT') {\n    if (typeof handler.onUpgrade !== 'function') {\n      throw new InvalidArgumentError('invalid onUpgrade method')\n    }\n  } else {\n    if (typeof handler.onHeaders !== 'function') {\n      throw new InvalidArgumentError('invalid onHeaders method')\n    }\n\n    if (typeof handler.onData !== 'function') {\n      throw new InvalidArgumentError('invalid onData method')\n    }\n\n    if (typeof handler.onComplete !== 'function') {\n      throw new InvalidArgumentError('invalid onComplete method')\n    }\n  }\n}\n\n// A body is disturbed if it has been read from and it cannot\n// be re-used without losing state or data.\nfunction isDisturbed (body) {\n  // TODO (fix): Why is body[kBodyUsed] needed?\n  return !!(body && (stream.isDisturbed(body) || body[kBodyUsed]))\n}\n\nfunction isErrored (body) {\n  return !!(body && stream.isErrored(body))\n}\n\nfunction isReadable (body) {\n  return !!(body && stream.isReadable(body))\n}\n\nfunction getSocketInfo (socket) {\n  return {\n    localAddress: socket.localAddress,\n    localPort: socket.localPort,\n    remoteAddress: socket.remoteAddress,\n    remotePort: socket.remotePort,\n    remoteFamily: socket.remoteFamily,\n    timeout: socket.timeout,\n    bytesWritten: socket.bytesWritten,\n    bytesRead: socket.bytesRead\n  }\n}\n\n/** @type {globalThis['ReadableStream']} */\nfunction ReadableStreamFrom (iterable) {\n  // We cannot use ReadableStream.from here because it does not return a byte stream.\n\n  let iterator\n  return new ReadableStream(\n    {\n      async start () {\n        iterator = iterable[Symbol.asyncIterator]()\n      },\n      async pull (controller) {\n        const { done, value } = await iterator.next()\n        if (done) {\n          queueMicrotask(() => {\n            controller.close()\n            controller.byobRequest?.respond(0)\n          })\n        } else {\n          const buf = Buffer.isBuffer(value) ? value : Buffer.from(value)\n          if (buf.byteLength) {\n            controller.enqueue(new Uint8Array(buf))\n          }\n        }\n        return controller.desiredSize > 0\n      },\n      async cancel (reason) {\n        await iterator.return()\n      },\n      type: 'bytes'\n    }\n  )\n}\n\n// The chunk should be a FormData instance and contains\n// all the required methods.\nfunction isFormDataLike (object) {\n  return (\n    object &&\n    typeof object === 'object' &&\n    typeof object.append === 'function' &&\n    typeof object.delete === 'function' &&\n    typeof object.get === 'function' &&\n    typeof object.getAll === 'function' &&\n    typeof object.has === 'function' &&\n    typeof object.set === 'function' &&\n    object[Symbol.toStringTag] === 'FormData'\n  )\n}\n\nfunction addAbortListener (signal, listener) {\n  if ('addEventListener' in signal) {\n    signal.addEventListener('abort', listener, { once: true })\n    return () => signal.removeEventListener('abort', listener)\n  }\n  signal.addListener('abort', listener)\n  return () => signal.removeListener('abort', listener)\n}\n\nconst hasToWellFormed = typeof String.prototype.toWellFormed === 'function'\nconst hasIsWellFormed = typeof String.prototype.isWellFormed === 'function'\n\n/**\n * @param {string} val\n */\nfunction toUSVString (val) {\n  return hasToWellFormed ? `${val}`.toWellFormed() : nodeUtil.toUSVString(val)\n}\n\n/**\n * @param {string} val\n */\n// TODO: move this to webidl\nfunction isUSVString (val) {\n  return hasIsWellFormed ? `${val}`.isWellFormed() : toUSVString(val) === `${val}`\n}\n\n/**\n * @see https://tools.ietf.org/html/rfc7230#section-3.2.6\n * @param {number} c\n */\nfunction isTokenCharCode (c) {\n  switch (c) {\n    case 0x22:\n    case 0x28:\n    case 0x29:\n    case 0x2c:\n    case 0x2f:\n    case 0x3a:\n    case 0x3b:\n    case 0x3c:\n    case 0x3d:\n    case 0x3e:\n    case 0x3f:\n    case 0x40:\n    case 0x5b:\n    case 0x5c:\n    case 0x5d:\n    case 0x7b:\n    case 0x7d:\n      // DQUOTE and \"(),/:;<=>?@[\\]{}\"\n      return false\n    default:\n      // VCHAR %x21-7E\n      return c >= 0x21 && c <= 0x7e\n  }\n}\n\n/**\n * @param {string} characters\n */\nfunction isValidHTTPToken (characters) {\n  if (characters.length === 0) {\n    return false\n  }\n  for (let i = 0; i < characters.length; ++i) {\n    if (!isTokenCharCode(characters.charCodeAt(i))) {\n      return false\n    }\n  }\n  return true\n}\n\n// headerCharRegex have been lifted from\n// https://github.com/nodejs/node/blob/main/lib/_http_common.js\n\n/**\n * Matches if val contains an invalid field-vchar\n *  field-value    = *( field-content / obs-fold )\n *  field-content  = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n *  field-vchar    = VCHAR / obs-text\n */\nconst headerCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/\n\n/**\n * @param {string} characters\n */\nfunction isValidHeaderValue (characters) {\n  return !headerCharRegex.test(characters)\n}\n\n// Parsed accordingly to RFC 9110\n// https://www.rfc-editor.org/rfc/rfc9110#field.content-range\nfunction parseRangeHeader (range) {\n  if (range == null || range === '') return { start: 0, end: null, size: null }\n\n  const m = range ? range.match(/^bytes (\\d+)-(\\d+)\\/(\\d+)?$/) : null\n  return m\n    ? {\n        start: parseInt(m[1]),\n        end: m[2] ? parseInt(m[2]) : null,\n        size: m[3] ? parseInt(m[3]) : null\n      }\n    : null\n}\n\nfunction addListener (obj, name, listener) {\n  const listeners = (obj[kListeners] ??= [])\n  listeners.push([name, listener])\n  obj.on(name, listener)\n  return obj\n}\n\nfunction removeAllListeners (obj) {\n  for (const [name, listener] of obj[kListeners] ?? []) {\n    obj.removeListener(name, listener)\n  }\n  obj[kListeners] = null\n}\n\nfunction errorRequest (client, request, err) {\n  try {\n    request.onError(err)\n    assert(request.aborted)\n  } catch (err) {\n    client.emit('error', err)\n  }\n}\n\nconst kEnumerableProperty = Object.create(null)\nkEnumerableProperty.enumerable = true\n\nconst normalizedMethodRecordsBase = {\n  delete: 'DELETE',\n  DELETE: 'DELETE',\n  get: 'GET',\n  GET: 'GET',\n  head: 'HEAD',\n  HEAD: 'HEAD',\n  options: 'OPTIONS',\n  OPTIONS: 'OPTIONS',\n  post: 'POST',\n  POST: 'POST',\n  put: 'PUT',\n  PUT: 'PUT'\n}\n\nconst normalizedMethodRecords = {\n  ...normalizedMethodRecordsBase,\n  patch: 'patch',\n  PATCH: 'PATCH'\n}\n\n// Note: object prototypes should not be able to be referenced. e.g. `Object#hasOwnProperty`.\nObject.setPrototypeOf(normalizedMethodRecordsBase, null)\nObject.setPrototypeOf(normalizedMethodRecords, null)\n\nmodule.exports = {\n  kEnumerableProperty,\n  nop,\n  isDisturbed,\n  isErrored,\n  isReadable,\n  toUSVString,\n  isUSVString,\n  isBlobLike,\n  parseOrigin,\n  parseURL,\n  getServerName,\n  isStream,\n  isIterable,\n  isAsyncIterable,\n  isDestroyed,\n  headerNameToString,\n  bufferToLowerCasedHeaderName,\n  addListener,\n  removeAllListeners,\n  errorRequest,\n  parseRawHeaders,\n  parseHeaders,\n  parseKeepAliveTimeout,\n  destroy,\n  bodyLength,\n  deepClone,\n  ReadableStreamFrom,\n  isBuffer,\n  validateHandler,\n  getSocketInfo,\n  isFormDataLike,\n  buildURL,\n  addAbortListener,\n  isValidHTTPToken,\n  isValidHeaderValue,\n  isTokenCharCode,\n  parseRangeHeader,\n  normalizedMethodRecordsBase,\n  normalizedMethodRecords,\n  isValidPort,\n  isHttpOrHttpsPrefixed,\n  nodeMajor,\n  nodeMinor,\n  safeHTTPMethods: ['GET', 'HEAD', 'OPTIONS', 'TRACE'],\n  wrapRequestBody\n}\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,MAAM,GAAGC,OAAO,CAAC,aAAa,CAAC;AACrC,MAAM;EAAEC,UAAU;EAAEC,SAAS;EAAEC,UAAU;EAAEC;AAAM,CAAC,GAAGJ,OAAO,CAAC,WAAW,CAAC;AACzE,MAAM;EAAEK;AAAgB,CAAC,GAAGL,OAAO,CAAC,WAAW,CAAC;AAChD,MAAMM,MAAM,GAAGN,OAAO,CAAC,aAAa,CAAC;AACrC,MAAMO,GAAG,GAAGP,OAAO,CAAC,UAAU,CAAC;AAC/B,MAAM;EAAEQ;AAAK,CAAC,GAAGR,OAAO,CAAC,aAAa,CAAC;AACvC,MAAMS,QAAQ,GAAGT,OAAO,CAAC,WAAW,CAAC;AACrC,MAAM;EAAEU;AAAU,CAAC,GAAGV,OAAO,CAAC,kBAAkB,CAAC;AACjD,MAAM;EAAEW,YAAY,EAAEC;AAAG,CAAC,GAAGZ,OAAO,CAAC,aAAa,CAAC;AACnD,MAAM;EAAEa;AAAqB,CAAC,GAAGb,OAAO,CAAC,UAAU,CAAC;AACpD,MAAM;EAAEc;AAA2B,CAAC,GAAGd,OAAO,CAAC,aAAa,CAAC;AAC7D,MAAM;EAAEe;AAAK,CAAC,GAAGf,OAAO,CAAC,QAAQ,CAAC;AAElC,MAAM,CAACgB,SAAS,EAAEC,SAAS,CAAC,GAAGC,OAAO,CAACC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAACC,CAAC,IAAIC,MAAM,CAACD,CAAC,CAAC,CAAC;AAEnF,MAAME,iBAAiB,CAAC;EACtBC,WAAWA,CAAEC,IAAI,EAAE;IACjB,IAAI,CAACvB,KAAK,CAAC,GAAGuB,IAAI;IAClB,IAAI,CAACzB,SAAS,CAAC,GAAG,KAAK;EACzB;EAEA,QAAS0B,MAAM,CAACC,aAAa,IAAK;IAChC9B,MAAM,CAAC,CAAC,IAAI,CAACG,SAAS,CAAC,EAAE,WAAW,CAAC;IACrC,IAAI,CAACA,SAAS,CAAC,GAAG,IAAI;IACtB,OAAQ,IAAI,CAACE,KAAK,CAAC;EACrB;AACF;AAEA,SAAS0B,eAAeA,CAAEH,IAAI,EAAE;EAC9B,IAAII,QAAQ,CAACJ,IAAI,CAAC,EAAE;IAClB;IACA;IACA;IACA,IAAIK,UAAU,CAACL,IAAI,CAAC,KAAK,CAAC,EAAE;MAC1BA,IAAI,CACDM,EAAE,CAAC,MAAM,EAAE,YAAY;QACtBlC,MAAM,CAAC,KAAK,CAAC;MACf,CAAC,CAAC;IACN;IAEA,IAAI,OAAO4B,IAAI,CAACO,eAAe,KAAK,SAAS,EAAE;MAC7CP,IAAI,CAACzB,SAAS,CAAC,GAAG,KAAK;MACvBU,EAAE,CAACuB,SAAS,CAACF,EAAE,CAACG,IAAI,CAACT,IAAI,EAAE,MAAM,EAAE,YAAY;QAC7C,IAAI,CAACzB,SAAS,CAAC,GAAG,IAAI;MACxB,CAAC,CAAC;IACJ;IAEA,OAAOyB,IAAI;EACb,CAAC,MAAM,IAAIA,IAAI,IAAI,OAAOA,IAAI,CAACU,MAAM,KAAK,UAAU,EAAE;IACpD;IACA;IACA;IACA,OAAO,IAAIZ,iBAAiB,CAACE,IAAI,CAAC;EACpC,CAAC,MAAM,IACLA,IAAI,IACJ,OAAOA,IAAI,KAAK,QAAQ,IACxB,CAACW,WAAW,CAACC,MAAM,CAACZ,IAAI,CAAC,IACzBa,UAAU,CAACb,IAAI,CAAC,EAChB;IACA;IACA;IACA,OAAO,IAAIF,iBAAiB,CAACE,IAAI,CAAC;EACpC,CAAC,MAAM;IACL,OAAOA,IAAI;EACb;AACF;AAEA,SAASc,GAAGA,CAAA,EAAI,CAAC;AAEjB,SAASV,QAAQA,CAAEW,GAAG,EAAE;EACtB,OAAOA,GAAG,IAAI,OAAOA,GAAG,KAAK,QAAQ,IAAI,OAAOA,GAAG,CAACC,IAAI,KAAK,UAAU,IAAI,OAAOD,GAAG,CAACT,EAAE,KAAK,UAAU;AACzG;;AAEA;AACA,SAASW,UAAUA,CAAEC,MAAM,EAAE;EAC3B,IAAIA,MAAM,KAAK,IAAI,EAAE;IACnB,OAAO,KAAK;EACd,CAAC,MAAM,IAAIA,MAAM,YAAYrC,IAAI,EAAE;IACjC,OAAO,IAAI;EACb,CAAC,MAAM,IAAI,OAAOqC,MAAM,KAAK,QAAQ,EAAE;IACrC,OAAO,KAAK;EACd,CAAC,MAAM;IACL,MAAMC,IAAI,GAAGD,MAAM,CAACjB,MAAM,CAACmB,WAAW,CAAC;IAEvC,OAAO,CAACD,IAAI,KAAK,MAAM,IAAIA,IAAI,KAAK,MAAM,MACvC,QAAQ,IAAID,MAAM,IAAI,OAAOA,MAAM,CAACvC,MAAM,KAAK,UAAU,IACzD,aAAa,IAAIuC,MAAM,IAAI,OAAOA,MAAM,CAACG,WAAW,KAAK,UAAW,CACtE;EACH;AACF;AAEA,SAASC,QAAQA,CAAEC,GAAG,EAAEC,WAAW,EAAE;EACnC,IAAID,GAAG,CAACE,QAAQ,CAAC,GAAG,CAAC,IAAIF,GAAG,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;IAC1C,MAAM,IAAIC,KAAK,CAAC,qEAAqE,CAAC;EACxF;EAEA,MAAMC,WAAW,GAAG5C,SAAS,CAACyC,WAAW,CAAC;EAE1C,IAAIG,WAAW,EAAE;IACfJ,GAAG,IAAI,GAAG,GAAGI,WAAW;EAC1B;EAEA,OAAOJ,GAAG;AACZ;AAEA,SAASK,WAAWA,CAAEC,IAAI,EAAE;EAC1B,MAAMC,KAAK,GAAGC,QAAQ,CAACF,IAAI,EAAE,EAAE,CAAC;EAChC,OACEC,KAAK,KAAKjC,MAAM,CAACgC,IAAI,CAAC,IACtBC,KAAK,IAAI,CAAC,IACVA,KAAK,IAAI,KAAK;AAElB;AAEA,SAASE,qBAAqBA,CAAEF,KAAK,EAAE;EACrC,OACEA,KAAK,IAAI,IAAI,IACbA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAChBA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAChBA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAChBA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,KAEdA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAEdA,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,IAChBA,KAAK,CAAC,CAAC,CAAC,KAAK,GACd,CACF;AAEL;AAEA,SAASG,QAAQA,CAAEV,GAAG,EAAE;EACtB,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;IAC3BA,GAAG,GAAG,IAAIW,GAAG,CAACX,GAAG,CAAC;IAElB,IAAI,CAACS,qBAAqB,CAACT,GAAG,CAACY,MAAM,IAAIZ,GAAG,CAACa,QAAQ,CAAC,EAAE;MACtD,MAAM,IAAIlD,oBAAoB,CAAC,oEAAoE,CAAC;IACtG;IAEA,OAAOqC,GAAG;EACZ;EAEA,IAAI,CAACA,GAAG,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;IACnC,MAAM,IAAIrC,oBAAoB,CAAC,0DAA0D,CAAC;EAC5F;EAEA,IAAI,EAAEqC,GAAG,YAAYW,GAAG,CAAC,EAAE;IACzB,IAAIX,GAAG,CAACM,IAAI,IAAI,IAAI,IAAIN,GAAG,CAACM,IAAI,KAAK,EAAE,IAAID,WAAW,CAACL,GAAG,CAACM,IAAI,CAAC,KAAK,KAAK,EAAE;MAC1E,MAAM,IAAI3C,oBAAoB,CAAC,qFAAqF,CAAC;IACvH;IAEA,IAAIqC,GAAG,CAACc,IAAI,IAAI,IAAI,IAAI,OAAOd,GAAG,CAACc,IAAI,KAAK,QAAQ,EAAE;MACpD,MAAM,IAAInD,oBAAoB,CAAC,gEAAgE,CAAC;IAClG;IAEA,IAAIqC,GAAG,CAACe,QAAQ,IAAI,IAAI,IAAI,OAAOf,GAAG,CAACe,QAAQ,KAAK,QAAQ,EAAE;MAC5D,MAAM,IAAIpD,oBAAoB,CAAC,wEAAwE,CAAC;IAC1G;IAEA,IAAIqC,GAAG,CAACgB,QAAQ,IAAI,IAAI,IAAI,OAAOhB,GAAG,CAACgB,QAAQ,KAAK,QAAQ,EAAE;MAC5D,MAAM,IAAIrD,oBAAoB,CAAC,wEAAwE,CAAC;IAC1G;IAEA,IAAIqC,GAAG,CAACY,MAAM,IAAI,IAAI,IAAI,OAAOZ,GAAG,CAACY,MAAM,KAAK,QAAQ,EAAE;MACxD,MAAM,IAAIjD,oBAAoB,CAAC,oEAAoE,CAAC;IACtG;IAEA,IAAI,CAAC8C,qBAAqB,CAACT,GAAG,CAACY,MAAM,IAAIZ,GAAG,CAACa,QAAQ,CAAC,EAAE;MACtD,MAAM,IAAIlD,oBAAoB,CAAC,oEAAoE,CAAC;IACtG;IAEA,MAAM2C,IAAI,GAAGN,GAAG,CAACM,IAAI,IAAI,IAAI,GACzBN,GAAG,CAACM,IAAI,GACPN,GAAG,CAACa,QAAQ,KAAK,QAAQ,GAAG,GAAG,GAAG,EAAG;IAC1C,IAAID,MAAM,GAAGZ,GAAG,CAACY,MAAM,IAAI,IAAI,GAC3BZ,GAAG,CAACY,MAAM,GACV,GAAGZ,GAAG,CAACa,QAAQ,IAAI,EAAE,KAAKb,GAAG,CAACgB,QAAQ,IAAI,EAAE,IAAIV,IAAI,EAAE;IAC1D,IAAIQ,IAAI,GAAGd,GAAG,CAACc,IAAI,IAAI,IAAI,GACvBd,GAAG,CAACc,IAAI,GACR,GAAGd,GAAG,CAACe,QAAQ,IAAI,EAAE,GAAGf,GAAG,CAACiB,MAAM,IAAI,EAAE,EAAE;IAE9C,IAAIL,MAAM,CAACA,MAAM,CAACM,MAAM,GAAG,CAAC,CAAC,KAAK,GAAG,EAAE;MACrCN,MAAM,GAAGA,MAAM,CAACO,KAAK,CAAC,CAAC,EAAEP,MAAM,CAACM,MAAM,GAAG,CAAC,CAAC;IAC7C;IAEA,IAAIJ,IAAI,IAAIA,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;MAC3BA,IAAI,GAAG,IAAIA,IAAI,EAAE;IACnB;IACA;IACA;IACA;IACA;IACA,OAAO,IAAIH,GAAG,CAAC,GAAGC,MAAM,GAAGE,IAAI,EAAE,CAAC;EACpC;EAEA,IAAI,CAACL,qBAAqB,CAACT,GAAG,CAACY,MAAM,IAAIZ,GAAG,CAACa,QAAQ,CAAC,EAAE;IACtD,MAAM,IAAIlD,oBAAoB,CAAC,oEAAoE,CAAC;EACtG;EAEA,OAAOqC,GAAG;AACZ;AAEA,SAASoB,WAAWA,CAAEpB,GAAG,EAAE;EACzBA,GAAG,GAAGU,QAAQ,CAACV,GAAG,CAAC;EAEnB,IAAIA,GAAG,CAACe,QAAQ,KAAK,GAAG,IAAIf,GAAG,CAACiB,MAAM,IAAIjB,GAAG,CAACqB,IAAI,EAAE;IAClD,MAAM,IAAI1D,oBAAoB,CAAC,aAAa,CAAC;EAC/C;EAEA,OAAOqC,GAAG;AACZ;AAEA,SAASsB,WAAWA,CAAEC,IAAI,EAAE;EAC1B,IAAIA,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IACnB,MAAMC,GAAG,GAAGD,IAAI,CAACE,OAAO,CAAC,GAAG,CAAC;IAE7B5E,MAAM,CAAC2E,GAAG,KAAK,CAAC,CAAC,CAAC;IAClB,OAAOD,IAAI,CAACG,SAAS,CAAC,CAAC,EAAEF,GAAG,CAAC;EAC/B;EAEA,MAAMA,GAAG,GAAGD,IAAI,CAACE,OAAO,CAAC,GAAG,CAAC;EAC7B,IAAID,GAAG,KAAK,CAAC,CAAC,EAAE,OAAOD,IAAI;EAE3B,OAAOA,IAAI,CAACG,SAAS,CAAC,CAAC,EAAEF,GAAG,CAAC;AAC/B;;AAEA;AACA;AACA,SAASG,aAAaA,CAAEJ,IAAI,EAAE;EAC5B,IAAI,CAACA,IAAI,EAAE;IACT,OAAO,IAAI;EACb;EAEA1E,MAAM,CAAC+E,WAAW,CAAC,OAAOL,IAAI,EAAE,QAAQ,CAAC;EAEzC,MAAMM,UAAU,GAAGP,WAAW,CAACC,IAAI,CAAC;EACpC,IAAIlE,GAAG,CAACyE,IAAI,CAACD,UAAU,CAAC,EAAE;IACxB,OAAO,EAAE;EACX;EAEA,OAAOA,UAAU;AACnB;AAEA,SAASE,SAASA,CAAEvC,GAAG,EAAE;EACvB,OAAOwC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACxE,SAAS,CAACgC,GAAG,CAAC,CAAC;AACxC;AAEA,SAAS0C,eAAeA,CAAE1C,GAAG,EAAE;EAC7B,OAAO,CAAC,EAAEA,GAAG,IAAI,IAAI,IAAI,OAAOA,GAAG,CAACd,MAAM,CAACC,aAAa,CAAC,KAAK,UAAU,CAAC;AAC3E;AAEA,SAASW,UAAUA,CAAEE,GAAG,EAAE;EACxB,OAAO,CAAC,EAAEA,GAAG,IAAI,IAAI,KAAK,OAAOA,GAAG,CAACd,MAAM,CAACyD,QAAQ,CAAC,KAAK,UAAU,IAAI,OAAO3C,GAAG,CAACd,MAAM,CAACC,aAAa,CAAC,KAAK,UAAU,CAAC,CAAC;AAC3H;AAEA,SAASG,UAAUA,CAAEL,IAAI,EAAE;EACzB,IAAIA,IAAI,IAAI,IAAI,EAAE;IAChB,OAAO,CAAC;EACV,CAAC,MAAM,IAAII,QAAQ,CAACJ,IAAI,CAAC,EAAE;IACzB,MAAM2D,KAAK,GAAG3D,IAAI,CAAC4D,cAAc;IACjC,OAAOD,KAAK,IAAIA,KAAK,CAACE,UAAU,KAAK,KAAK,IAAIF,KAAK,CAACG,KAAK,KAAK,IAAI,IAAIjE,MAAM,CAACkE,QAAQ,CAACJ,KAAK,CAAClB,MAAM,CAAC,GAC/FkB,KAAK,CAAClB,MAAM,GACZ,IAAI;EACV,CAAC,MAAM,IAAIxB,UAAU,CAACjB,IAAI,CAAC,EAAE;IAC3B,OAAOA,IAAI,CAACgE,IAAI,IAAI,IAAI,GAAGhE,IAAI,CAACgE,IAAI,GAAG,IAAI;EAC7C,CAAC,MAAM,IAAIC,QAAQ,CAACjE,IAAI,CAAC,EAAE;IACzB,OAAOA,IAAI,CAACkE,UAAU;EACxB;EAEA,OAAO,IAAI;AACb;AAEA,SAASC,WAAWA,CAAEnE,IAAI,EAAE;EAC1B,OAAOA,IAAI,IAAI,CAAC,EAAEA,IAAI,CAACoE,SAAS,IAAIpE,IAAI,CAAC1B,UAAU,CAAC,IAAKK,MAAM,CAACwF,WAAW,GAAGnE,IAAI,CAAE,CAAC;AACvF;AAEA,SAASqE,OAAOA,CAAE1F,MAAM,EAAE2F,GAAG,EAAE;EAC7B,IAAI3F,MAAM,IAAI,IAAI,IAAI,CAACyB,QAAQ,CAACzB,MAAM,CAAC,IAAIwF,WAAW,CAACxF,MAAM,CAAC,EAAE;IAC9D;EACF;EAEA,IAAI,OAAOA,MAAM,CAAC0F,OAAO,KAAK,UAAU,EAAE;IACxC,IAAIE,MAAM,CAACC,cAAc,CAAC7F,MAAM,CAAC,CAACoB,WAAW,KAAKrB,eAAe,EAAE;MACjE;MACAC,MAAM,CAAC8F,MAAM,GAAG,IAAI;IACtB;IAEA9F,MAAM,CAAC0F,OAAO,CAACC,GAAG,CAAC;EACrB,CAAC,MAAM,IAAIA,GAAG,EAAE;IACdI,cAAc,CAAC,MAAM;MACnB/F,MAAM,CAACgG,IAAI,CAAC,OAAO,EAAEL,GAAG,CAAC;IAC3B,CAAC,CAAC;EACJ;EAEA,IAAI3F,MAAM,CAACyF,SAAS,KAAK,IAAI,EAAE;IAC7BzF,MAAM,CAACL,UAAU,CAAC,GAAG,IAAI;EAC3B;AACF;AAEA,MAAMsG,sBAAsB,GAAG,eAAe;AAC9C,SAASC,qBAAqBA,CAAEC,GAAG,EAAE;EACnC,MAAMC,CAAC,GAAGD,GAAG,CAACE,QAAQ,CAAC,CAAC,CAACC,KAAK,CAACL,sBAAsB,CAAC;EACtD,OAAOG,CAAC,GAAGhD,QAAQ,CAACgD,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,IAAI,GAAG,IAAI;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASG,kBAAkBA,CAAEpD,KAAK,EAAE;EAClC,OAAO,OAAOA,KAAK,KAAK,QAAQ,GAC5B3C,0BAA0B,CAAC2C,KAAK,CAAC,IAAIA,KAAK,CAACqD,WAAW,CAAC,CAAC,GACxD/F,IAAI,CAACgG,MAAM,CAACtD,KAAK,CAAC,IAAIA,KAAK,CAACkD,QAAQ,CAAC,QAAQ,CAAC,CAACG,WAAW,CAAC,CAAC;AAClE;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASE,4BAA4BA,CAAEvD,KAAK,EAAE;EAC5C,OAAO1C,IAAI,CAACgG,MAAM,CAACtD,KAAK,CAAC,IAAIA,KAAK,CAACkD,QAAQ,CAAC,QAAQ,CAAC,CAACG,WAAW,CAAC,CAAC;AACrE;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASG,YAAYA,CAAEC,OAAO,EAAExE,GAAG,EAAE;EACnC,IAAIA,GAAG,KAAKyE,SAAS,EAAEzE,GAAG,GAAG,CAAC,CAAC;EAC/B,KAAK,IAAI0E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,OAAO,CAAC9C,MAAM,EAAEgD,CAAC,IAAI,CAAC,EAAE;IAC1C,MAAMC,GAAG,GAAGR,kBAAkB,CAACK,OAAO,CAACE,CAAC,CAAC,CAAC;IAC1C,IAAIX,GAAG,GAAG/D,GAAG,CAAC2E,GAAG,CAAC;IAElB,IAAIZ,GAAG,EAAE;MACP,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;QAC3BA,GAAG,GAAG,CAACA,GAAG,CAAC;QACX/D,GAAG,CAAC2E,GAAG,CAAC,GAAGZ,GAAG;MAChB;MACAA,GAAG,CAACa,IAAI,CAACJ,OAAO,CAACE,CAAC,GAAG,CAAC,CAAC,CAACT,QAAQ,CAAC,MAAM,CAAC,CAAC;IAC3C,CAAC,MAAM;MACL,MAAMY,YAAY,GAAGL,OAAO,CAACE,CAAC,GAAG,CAAC,CAAC;MACnC,IAAI,OAAOG,YAAY,KAAK,QAAQ,EAAE;QACpC7E,GAAG,CAAC2E,GAAG,CAAC,GAAGE,YAAY;MACzB,CAAC,MAAM;QACL7E,GAAG,CAAC2E,GAAG,CAAC,GAAGG,KAAK,CAACC,OAAO,CAACF,YAAY,CAAC,GAAGA,YAAY,CAACjG,GAAG,CAACoG,CAAC,IAAIA,CAAC,CAACf,QAAQ,CAAC,MAAM,CAAC,CAAC,GAAGY,YAAY,CAACZ,QAAQ,CAAC,MAAM,CAAC;MACpH;IACF;EACF;;EAEA;EACA,IAAI,gBAAgB,IAAIjE,GAAG,IAAI,qBAAqB,IAAIA,GAAG,EAAE;IAC3DA,GAAG,CAAC,qBAAqB,CAAC,GAAGiF,MAAM,CAACC,IAAI,CAAClF,GAAG,CAAC,qBAAqB,CAAC,CAAC,CAACiE,QAAQ,CAAC,QAAQ,CAAC;EACzF;EAEA,OAAOjE,GAAG;AACZ;AAEA,SAASmF,eAAeA,CAAEX,OAAO,EAAE;EACjC,MAAMY,GAAG,GAAGZ,OAAO,CAAC9C,MAAM;EAC1B,MAAM2D,GAAG,GAAG,IAAIP,KAAK,CAACM,GAAG,CAAC;EAE1B,IAAIE,gBAAgB,GAAG,KAAK;EAC5B,IAAIC,qBAAqB,GAAG,CAAC,CAAC;EAC9B,IAAIZ,GAAG;EACP,IAAIZ,GAAG;EACP,IAAIyB,IAAI,GAAG,CAAC;EAEZ,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGjB,OAAO,CAAC9C,MAAM,EAAE+D,CAAC,IAAI,CAAC,EAAE;IAC1Cd,GAAG,GAAGH,OAAO,CAACiB,CAAC,CAAC;IAChB1B,GAAG,GAAGS,OAAO,CAACiB,CAAC,GAAG,CAAC,CAAC;IAEpB,OAAOd,GAAG,KAAK,QAAQ,KAAKA,GAAG,GAAGA,GAAG,CAACV,QAAQ,CAAC,CAAC,CAAC;IACjD,OAAOF,GAAG,KAAK,QAAQ,KAAKA,GAAG,GAAGA,GAAG,CAACE,QAAQ,CAAC,MAAM,CAAC,CAAC;IAEvDuB,IAAI,GAAGb,GAAG,CAACjD,MAAM;IACjB,IAAI8D,IAAI,KAAK,EAAE,IAAIb,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,KAAKA,GAAG,KAAK,gBAAgB,IAAIA,GAAG,CAACP,WAAW,CAAC,CAAC,KAAK,gBAAgB,CAAC,EAAE;MACzGkB,gBAAgB,GAAG,IAAI;IACzB,CAAC,MAAM,IAAIE,IAAI,KAAK,EAAE,IAAIb,GAAG,CAAC,CAAC,CAAC,KAAK,GAAG,KAAKA,GAAG,KAAK,qBAAqB,IAAIA,GAAG,CAACP,WAAW,CAAC,CAAC,KAAK,qBAAqB,CAAC,EAAE;MAC1HmB,qBAAqB,GAAGE,CAAC,GAAG,CAAC;IAC/B;IACAJ,GAAG,CAACI,CAAC,CAAC,GAAGd,GAAG;IACZU,GAAG,CAACI,CAAC,GAAG,CAAC,CAAC,GAAG1B,GAAG;EAClB;;EAEA;EACA,IAAIuB,gBAAgB,IAAIC,qBAAqB,KAAK,CAAC,CAAC,EAAE;IACpDF,GAAG,CAACE,qBAAqB,CAAC,GAAGN,MAAM,CAACC,IAAI,CAACG,GAAG,CAACE,qBAAqB,CAAC,CAAC,CAACtB,QAAQ,CAAC,QAAQ,CAAC;EACzF;EAEA,OAAOoB,GAAG;AACZ;AAEA,SAASnC,QAAQA,CAAEwC,MAAM,EAAE;EACzB;EACA,OAAOA,MAAM,YAAYC,UAAU,IAAIV,MAAM,CAAC/B,QAAQ,CAACwC,MAAM,CAAC;AAChE;AAEA,SAASE,eAAeA,CAAEC,OAAO,EAAEC,MAAM,EAAEC,OAAO,EAAE;EAClD,IAAI,CAACF,OAAO,IAAI,OAAOA,OAAO,KAAK,QAAQ,EAAE;IAC3C,MAAM,IAAI1H,oBAAoB,CAAC,2BAA2B,CAAC;EAC7D;EAEA,IAAI,OAAO0H,OAAO,CAACG,SAAS,KAAK,UAAU,EAAE;IAC3C,MAAM,IAAI7H,oBAAoB,CAAC,0BAA0B,CAAC;EAC5D;EAEA,IAAI,OAAO0H,OAAO,CAACI,OAAO,KAAK,UAAU,EAAE;IACzC,MAAM,IAAI9H,oBAAoB,CAAC,wBAAwB,CAAC;EAC1D;EAEA,IAAI,OAAO0H,OAAO,CAACK,UAAU,KAAK,UAAU,IAAIL,OAAO,CAACK,UAAU,KAAKzB,SAAS,EAAE;IAChF,MAAM,IAAItG,oBAAoB,CAAC,2BAA2B,CAAC;EAC7D;EAEA,IAAI4H,OAAO,IAAID,MAAM,KAAK,SAAS,EAAE;IACnC,IAAI,OAAOD,OAAO,CAACM,SAAS,KAAK,UAAU,EAAE;MAC3C,MAAM,IAAIhI,oBAAoB,CAAC,0BAA0B,CAAC;IAC5D;EACF,CAAC,MAAM;IACL,IAAI,OAAO0H,OAAO,CAACO,SAAS,KAAK,UAAU,EAAE;MAC3C,MAAM,IAAIjI,oBAAoB,CAAC,0BAA0B,CAAC;IAC5D;IAEA,IAAI,OAAO0H,OAAO,CAACQ,MAAM,KAAK,UAAU,EAAE;MACxC,MAAM,IAAIlI,oBAAoB,CAAC,uBAAuB,CAAC;IACzD;IAEA,IAAI,OAAO0H,OAAO,CAACS,UAAU,KAAK,UAAU,EAAE;MAC5C,MAAM,IAAInI,oBAAoB,CAAC,2BAA2B,CAAC;IAC7D;EACF;AACF;;AAEA;AACA;AACA,SAASoI,WAAWA,CAAEtH,IAAI,EAAE;EAC1B;EACA,OAAO,CAAC,EAAEA,IAAI,KAAKrB,MAAM,CAAC2I,WAAW,CAACtH,IAAI,CAAC,IAAIA,IAAI,CAACzB,SAAS,CAAC,CAAC,CAAC;AAClE;AAEA,SAASgJ,SAASA,CAAEvH,IAAI,EAAE;EACxB,OAAO,CAAC,EAAEA,IAAI,IAAIrB,MAAM,CAAC4I,SAAS,CAACvH,IAAI,CAAC,CAAC;AAC3C;AAEA,SAASwH,UAAUA,CAAExH,IAAI,EAAE;EACzB,OAAO,CAAC,EAAEA,IAAI,IAAIrB,MAAM,CAAC6I,UAAU,CAACxH,IAAI,CAAC,CAAC;AAC5C;AAEA,SAASyH,aAAaA,CAAEhD,MAAM,EAAE;EAC9B,OAAO;IACLiD,YAAY,EAAEjD,MAAM,CAACiD,YAAY;IACjCC,SAAS,EAAElD,MAAM,CAACkD,SAAS;IAC3BC,aAAa,EAAEnD,MAAM,CAACmD,aAAa;IACnCC,UAAU,EAAEpD,MAAM,CAACoD,UAAU;IAC7BC,YAAY,EAAErD,MAAM,CAACqD,YAAY;IACjCC,OAAO,EAAEtD,MAAM,CAACsD,OAAO;IACvBC,YAAY,EAAEvD,MAAM,CAACuD,YAAY;IACjCC,SAAS,EAAExD,MAAM,CAACwD;EACpB,CAAC;AACH;;AAEA;AACA,SAASC,kBAAkBA,CAAEC,QAAQ,EAAE;EACrC;;EAEA,IAAIzE,QAAQ;EACZ,OAAO,IAAI0E,cAAc,CACvB;IACE,MAAMC,KAAKA,CAAA,EAAI;MACb3E,QAAQ,GAAGyE,QAAQ,CAAClI,MAAM,CAACC,aAAa,CAAC,CAAC,CAAC;IAC7C,CAAC;IACD,MAAMoI,IAAIA,CAAEC,UAAU,EAAE;MACtB,MAAM;QAAEC,IAAI;QAAE1G;MAAM,CAAC,GAAG,MAAM4B,QAAQ,CAAC+E,IAAI,CAAC,CAAC;MAC7C,IAAID,IAAI,EAAE;QACR9D,cAAc,CAAC,MAAM;UACnB6D,UAAU,CAACG,KAAK,CAAC,CAAC;UAClBH,UAAU,CAACI,WAAW,EAAEC,OAAO,CAAC,CAAC,CAAC;QACpC,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,MAAMC,GAAG,GAAG7C,MAAM,CAAC/B,QAAQ,CAACnC,KAAK,CAAC,GAAGA,KAAK,GAAGkE,MAAM,CAACC,IAAI,CAACnE,KAAK,CAAC;QAC/D,IAAI+G,GAAG,CAAC3E,UAAU,EAAE;UAClBqE,UAAU,CAACO,OAAO,CAAC,IAAIpC,UAAU,CAACmC,GAAG,CAAC,CAAC;QACzC;MACF;MACA,OAAON,UAAU,CAACQ,WAAW,GAAG,CAAC;IACnC,CAAC;IACD,MAAMC,MAAMA,CAAEC,MAAM,EAAE;MACpB,MAAMvF,QAAQ,CAACwF,MAAM,CAAC,CAAC;IACzB,CAAC;IACDC,IAAI,EAAE;EACR,CACF,CAAC;AACH;;AAEA;AACA;AACA,SAASC,cAAcA,CAAElI,MAAM,EAAE;EAC/B,OACEA,MAAM,IACN,OAAOA,MAAM,KAAK,QAAQ,IAC1B,OAAOA,MAAM,CAACmI,MAAM,KAAK,UAAU,IACnC,OAAOnI,MAAM,CAACoI,MAAM,KAAK,UAAU,IACnC,OAAOpI,MAAM,CAACqI,GAAG,KAAK,UAAU,IAChC,OAAOrI,MAAM,CAACsI,MAAM,KAAK,UAAU,IACnC,OAAOtI,MAAM,CAACuI,GAAG,KAAK,UAAU,IAChC,OAAOvI,MAAM,CAACwI,GAAG,KAAK,UAAU,IAChCxI,MAAM,CAACjB,MAAM,CAACmB,WAAW,CAAC,KAAK,UAAU;AAE7C;AAEA,SAASuI,gBAAgBA,CAAEC,MAAM,EAAEC,QAAQ,EAAE;EAC3C,IAAI,kBAAkB,IAAID,MAAM,EAAE;IAChCA,MAAM,CAACE,gBAAgB,CAAC,OAAO,EAAED,QAAQ,EAAE;MAAEE,IAAI,EAAE;IAAK,CAAC,CAAC;IAC1D,OAAO,MAAMH,MAAM,CAACI,mBAAmB,CAAC,OAAO,EAAEH,QAAQ,CAAC;EAC5D;EACAD,MAAM,CAACK,WAAW,CAAC,OAAO,EAAEJ,QAAQ,CAAC;EACrC,OAAO,MAAMD,MAAM,CAACM,cAAc,CAAC,OAAO,EAAEL,QAAQ,CAAC;AACvD;AAEA,MAAMM,eAAe,GAAG,OAAOC,MAAM,CAAC5J,SAAS,CAAC6J,YAAY,KAAK,UAAU;AAC3E,MAAMC,eAAe,GAAG,OAAOF,MAAM,CAAC5J,SAAS,CAAC+J,YAAY,KAAK,UAAU;;AAE3E;AACA;AACA;AACA,SAASC,WAAWA,CAAE1F,GAAG,EAAE;EACzB,OAAOqF,eAAe,GAAG,GAAGrF,GAAG,EAAE,CAACuF,YAAY,CAAC,CAAC,GAAGvL,QAAQ,CAAC0L,WAAW,CAAC1F,GAAG,CAAC;AAC9E;;AAEA;AACA;AACA;AACA;AACA,SAAS2F,WAAWA,CAAE3F,GAAG,EAAE;EACzB,OAAOwF,eAAe,GAAG,GAAGxF,GAAG,EAAE,CAACyF,YAAY,CAAC,CAAC,GAAGC,WAAW,CAAC1F,GAAG,CAAC,KAAK,GAAGA,GAAG,EAAE;AAClF;;AAEA;AACA;AACA;AACA;AACA,SAAS4F,eAAeA,CAAEC,CAAC,EAAE;EAC3B,QAAQA,CAAC;IACP,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;IACT,KAAK,IAAI;MACP;MACA,OAAO,KAAK;IACd;MACE;MACA,OAAOA,CAAC,IAAI,IAAI,IAAIA,CAAC,IAAI,IAAI;EACjC;AACF;;AAEA;AACA;AACA;AACA,SAASC,gBAAgBA,CAAEC,UAAU,EAAE;EACrC,IAAIA,UAAU,CAACpI,MAAM,KAAK,CAAC,EAAE;IAC3B,OAAO,KAAK;EACd;EACA,KAAK,IAAIgD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGoF,UAAU,CAACpI,MAAM,EAAE,EAAEgD,CAAC,EAAE;IAC1C,IAAI,CAACiF,eAAe,CAACG,UAAU,CAACC,UAAU,CAACrF,CAAC,CAAC,CAAC,EAAE;MAC9C,OAAO,KAAK;IACd;EACF;EACA,OAAO,IAAI;AACb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMsF,eAAe,GAAG,yBAAyB;;AAEjD;AACA;AACA;AACA,SAASC,kBAAkBA,CAAEH,UAAU,EAAE;EACvC,OAAO,CAACE,eAAe,CAACE,IAAI,CAACJ,UAAU,CAAC;AAC1C;;AAEA;AACA;AACA,SAASK,gBAAgBA,CAAEC,KAAK,EAAE;EAChC,IAAIA,KAAK,IAAI,IAAI,IAAIA,KAAK,KAAK,EAAE,EAAE,OAAO;IAAE9C,KAAK,EAAE,CAAC;IAAE+C,GAAG,EAAE,IAAI;IAAEpH,IAAI,EAAE;EAAK,CAAC;EAE7E,MAAMe,CAAC,GAAGoG,KAAK,GAAGA,KAAK,CAAClG,KAAK,CAAC,6BAA6B,CAAC,GAAG,IAAI;EACnE,OAAOF,CAAC,GACJ;IACEsD,KAAK,EAAEtG,QAAQ,CAACgD,CAAC,CAAC,CAAC,CAAC,CAAC;IACrBqG,GAAG,EAAErG,CAAC,CAAC,CAAC,CAAC,GAAGhD,QAAQ,CAACgD,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI;IACjCf,IAAI,EAAEe,CAAC,CAAC,CAAC,CAAC,GAAGhD,QAAQ,CAACgD,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG;EAChC,CAAC,GACD,IAAI;AACV;AAEA,SAASkF,WAAWA,CAAElJ,GAAG,EAAEsK,IAAI,EAAExB,QAAQ,EAAE;EACzC,MAAMyB,SAAS,GAAIvK,GAAG,CAACvC,UAAU,CAAC,KAAK,EAAG;EAC1C8M,SAAS,CAAC3F,IAAI,CAAC,CAAC0F,IAAI,EAAExB,QAAQ,CAAC,CAAC;EAChC9I,GAAG,CAACT,EAAE,CAAC+K,IAAI,EAAExB,QAAQ,CAAC;EACtB,OAAO9I,GAAG;AACZ;AAEA,SAASwK,kBAAkBA,CAAExK,GAAG,EAAE;EAChC,KAAK,MAAM,CAACsK,IAAI,EAAExB,QAAQ,CAAC,IAAI9I,GAAG,CAACvC,UAAU,CAAC,IAAI,EAAE,EAAE;IACpDuC,GAAG,CAACmJ,cAAc,CAACmB,IAAI,EAAExB,QAAQ,CAAC;EACpC;EACA9I,GAAG,CAACvC,UAAU,CAAC,GAAG,IAAI;AACxB;AAEA,SAASgN,YAAYA,CAAEC,MAAM,EAAEC,OAAO,EAAEpH,GAAG,EAAE;EAC3C,IAAI;IACFoH,OAAO,CAAC1E,OAAO,CAAC1C,GAAG,CAAC;IACpBlG,MAAM,CAACsN,OAAO,CAACC,OAAO,CAAC;EACzB,CAAC,CAAC,OAAOrH,GAAG,EAAE;IACZmH,MAAM,CAAC9G,IAAI,CAAC,OAAO,EAAEL,GAAG,CAAC;EAC3B;AACF;AAEA,MAAMsH,mBAAmB,GAAGrH,MAAM,CAACsH,MAAM,CAAC,IAAI,CAAC;AAC/CD,mBAAmB,CAACE,UAAU,GAAG,IAAI;AAErC,MAAMC,2BAA2B,GAAG;EAClCzC,MAAM,EAAE,QAAQ;EAChB0C,MAAM,EAAE,QAAQ;EAChBzC,GAAG,EAAE,KAAK;EACV0C,GAAG,EAAE,KAAK;EACVC,IAAI,EAAE,MAAM;EACZC,IAAI,EAAE,MAAM;EACZC,OAAO,EAAE,SAAS;EAClBC,OAAO,EAAE,SAAS;EAClBC,IAAI,EAAE,MAAM;EACZC,IAAI,EAAE,MAAM;EACZC,GAAG,EAAE,KAAK;EACVC,GAAG,EAAE;AACP,CAAC;AAED,MAAMC,uBAAuB,GAAG;EAC9B,GAAGX,2BAA2B;EAC9BY,KAAK,EAAE,OAAO;EACdC,KAAK,EAAE;AACT,CAAC;;AAED;AACArI,MAAM,CAACsI,cAAc,CAACd,2BAA2B,EAAE,IAAI,CAAC;AACxDxH,MAAM,CAACsI,cAAc,CAACH,uBAAuB,EAAE,IAAI,CAAC;AAEpDI,MAAM,CAACC,OAAO,GAAG;EACfnB,mBAAmB;EACnB9K,GAAG;EACHwG,WAAW;EACXC,SAAS;EACTC,UAAU;EACVgD,WAAW;EACXC,WAAW;EACXxJ,UAAU;EACV0B,WAAW;EACXV,QAAQ;EACRiB,aAAa;EACb9C,QAAQ;EACRS,UAAU;EACV4C,eAAe;EACfU,WAAW;EACXe,kBAAkB;EAClBG,4BAA4B;EAC5B4E,WAAW;EACXsB,kBAAkB;EAClBC,YAAY;EACZtF,eAAe;EACfZ,YAAY;EACZT,qBAAqB;EACrBR,OAAO;EACPhE,UAAU;EACViD,SAAS;EACT4E,kBAAkB;EAClBjE,QAAQ;EACR0C,eAAe;EACfc,aAAa;EACb2B,cAAc;EACd9H,QAAQ;EACRqI,gBAAgB;EAChBiB,gBAAgB;EAChBI,kBAAkB;EAClBN,eAAe;EACfQ,gBAAgB;EAChBa,2BAA2B;EAC3BW,uBAAuB;EACvB9K,WAAW;EACXI,qBAAqB;EACrB3C,SAAS;EACTC,SAAS;EACT0N,eAAe,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,CAAC;EACpD7M;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}